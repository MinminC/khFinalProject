<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="memberMapper">
 	
 	<resultMap type="member" id="memberResultSet">
 		<result column="USER_NO" property="userNo"/>
 		<result column="USER_ID" property="userId"/>
 		<result column="USER_PWD" property="userPwd"/>
 		<result column="USER_NAME" property="userName"/>
 		<result column="BIRTH" property="birth"/>
 		<result column="GENDER" property="gender"/>
 		<result column="PHONE" property="phone"/>
 		<result column="EMAIL" property="email"/>
 		<result column="ENROLL_DATE" property="enrollDate"/>
 		<result column="MODIFY_DATE" property="modifyDate"/>
 		<result column="STATUS" property="status"/>
 		<result column="MO_NO" property="moNo"/>
 	</resultMap>
 
 	<resultMap type="inquiry" id="inquiryResultSet">
  		<result column="INQ_NO" property="inqNo"/>
  		<result column="USER_NO" property="userNo"/>
  		<result column="INQ_TITLE" property="inqTitle"/>
  		<result column="INQ_CONTENT" property="inqContent"/>
  		<result column="INQ_REPLY" property="inqReply"/>
  		<result column="INQ_STATUS" property="inqStatus"/>
  		<result column="STATUS" property="status"/>
  		<result column="CREATE_DATE" property="createDate"/>
  	</resultMap>
 
 	<!-- 로그인용 쿼리문 -->
 	<select id="loginMember" resultMap="memberResultSet" parameterType="member">
 		select 
 				USER_NO
 				,USER_ID
 				,USER_PWD
 				,USER_NAME
 				,BIRTH
 				,GENDER
 				,PHONE
 				,EMAIL
 				,ENROLL_DATE
 				,MODIFY_DATE
 				,STATUS
 				,MO_NO
 		from	
 				MEMBER
 		where	
 				USER_ID=#{userId}
 		and			
 				USER_PWD=#{userPwd}
 		and			
 				STATUS='Y'
 		
 	
 	</select>
 
    <!-- 문의하기 -->
 	<insert id="insertInquiry" parameterType="Inquiry">
 		INSERT INTO INQUIRY(INQ_NO, USER_NO, INQ_TITLE, INQ_CONTENT)
 		VALUES (SEQ_INQUIRY_NO.NEXTVAL, #{userNo}, #{inqTitle}, #{inqContent})
 	</insert>
 	
 	<!-- 문의내역 수(1:1문의) -->
 	<select id="selectListCount" resultType="_int">
  		SELECT COUNT(*)
  		FROM INQUIRY
  		WHERE STATUS = 'Y'
  	</select>
  	
  	<!-- 문의내역 조회(1:1문의) -->
  	<select id="selectList" resultMap="inquiryResultSet" parameterType="INQUIRY">
		SELECT INQ_NO, INQ_TITLE, TO_CHAR(CREATE_DATE, 'YYYY-MM-DD') AS "CREATE_DATE", INQ_STATUS
		FROM INQUIRY
		WHERE STATUS = 'Y'
		ORDER BY INQ_NO DESC
	</select>
	
	<!-- 문의 내역 수정(조회) -->
	<select id="selectInquiry" resultMap="inquiryResultSet">
		SELECT INQ_TITLE, INQ_CONTENT, INQ_NO
		FROM INQUIRY
		WHERE STATUS = 'Y'
		AND INQ_NO = #{No}
	</select>
	
	<!-- 문의 내역 수정 -->
	<update id="updateInquiry" parameterType="inquiry">
		UPDATE INQUIRY
		SET 
		   INQ_TITLE = #{inqTitle}
		   ,INQ_CONTENT = #{inqContent}
		WHERE INQ_NO = #{inqNo}
	</update>
	
	<!-- 나의 문의 삭제 -->
	<update id="deleteInquiry" parameterType="_int">
		UPDATE INQUIRY
		SET STATUS = 'N'
		WHERE INQ_NO = #{No}
	</update>
	
	<!-- 개인정보변경 -->
	<update id="updateEnrollForm" parameterType="member">
		UPDATE MEMBER
		SET PHONE = #{phone},
			EMAIL = #{email}
		WHERE USER_ID = #{userId}
	</update>
	
	
</mapper>